document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelectorAll(".hyperpress-map-canvas");0!==t.length&&t.forEach((function(t){const e=t.dataset.field,n=parseFloat(t.dataset.lat)||51.505,a=parseFloat(t.dataset.lng)||-.09,o=parseInt(t.dataset.zoom,10)||13,l=document.getElementById(e+"_lat"),r=document.getElementById(e+"_lng"),s=document.getElementById(e+"_address"),d=L.map(t).setView([n,a],o);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d);let c=L.marker([n,a],{draggable:!0}).addTo(d);c.on("dragend",(function(t){const e=c.getLatLng();l.value=e.lat,r.value=e.lng})),d.on("click",(function(t){const e=t.latlng;c.setLatLng(e),l.value=e.lat,r.value=e.lng}));const g=document.querySelector(`.hyperpress-geocode-button[data-field="${e}"]`);g&&g.addEventListener("click",(function(){const t=s.value;t&&fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}`).then((t=>t.json())).then((t=>{if(t&&t.length>0){const e=parseFloat(t[0].lat),n=parseFloat(t[0].lon),a=new L.LatLng(e,n);d.setView(a,o),c.setLatLng(a),l.value=e,r.value=n}else alert("Address not found.")})).catch((t=>console.error("Error during geocoding:",t)))}))}))}));